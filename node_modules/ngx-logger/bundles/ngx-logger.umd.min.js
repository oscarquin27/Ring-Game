!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("vlq"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-logger",["exports","@angular/core","@angular/common/http","rxjs/operators","vlq","rxjs","@angular/common"],t):t(e["ngx-logger"]={},e.ng.core,e.ng.common.http,e.Rx.Observable.prototype,e.vlq,e.rxjs,e.ng.common)}(this,function(e,t,d,c,l,s,o){"use strict";function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}var r=function(){function e(e){this.httpBackend=e}return e.prototype.logOnServer=function(e,t,r){var n=new d.HttpRequest("POST",e,t,r||{});return this.httpBackend.handle(n).pipe(c.filter(function(e){return e instanceof d.HttpResponse}),c.map(function(e){return e.body}))},e}();r.decorators=[{type:t.Injectable}],r.ctorParameters=function(){return[{type:d.HttpBackend}]};var y={TRACE:0,DEBUG:1,INFO:2,LOG:3,WARN:4,ERROR:5,FATAL:6,OFF:7};y[y.TRACE]="TRACE",y[y.DEBUG]="DEBUG",y[y.INFO]="INFO",y[y.LOG]="LOG",y[y.WARN]="WARN",y[y.ERROR]="ERROR",y[y.FATAL]="FATAL",y[y.OFF]="OFF";var n=function _(){},a=function(){function e(e){this.config=e,this._config=e}return e.prototype.updateConfig=function(e){this._config=this._clone(e)},e.prototype.getConfig=function(){return this._clone(this._config)},e.prototype._clone=function(t){var r=new n;return Object.keys(t).forEach(function(e){r[e]=t[e]}),r},e}(),v=function(){function e(){}return e.prepareMetaString=function(e,t,r,n){return e+" "+t+(r?" ["+r+":"+n+"]":"")},e.getColor=function(e){switch(e){case y.TRACE:return"blue";case y.DEBUG:return"teal";case y.INFO:case y.LOG:return"gray";case y.WARN:case y.ERROR:case y.FATAL:return"red";case y.OFF:default:return}},e.getCallerDetails=function(){var e=new Error("");try{var t=e.stack.split("\n")[4].split("/"),r=t[t.length-1].replace(/[)]/g,"").split(":");return{fileName:r[0],lineNumber:r[1]}}catch(n){return{fileName:null,lineNumber:null}}},e.prepareMessage=function(e){try{"string"==typeof e||e instanceof Error||(e=JSON.stringify(e,null,2))}catch(t){e='The provided "message" value could not be parsed with JSON.stringify().'}return e},e.prepareAdditionalParameters=function(e){return null===e||e===undefined?null:e.map(function(e,t){try{return"object"==typeof e&&JSON.stringify(e),e}catch(r){return"The additional["+t+"] value could not be parsed using JSON.stringify()."}})},e}(),f=function(){function e(e,t,r){this.fileName=e,this.lineNumber=t,this.columnNumber=r}return e.prototype.toString=function(){return this.fileName+":"+this.lineNumber+":"+this.columnNumber},e}(),p=function(){function a(e){this.httpBackend=e,this.cache={},this.errorCache={}}return a.getStackLine=function(){var e=new Error;try{throw e}catch(t){try{return e.stack.split("\n")[5]}catch(t){return null}}},a.getPosition=function(e){var t=e.substring(e.lastIndexOf("/")+1,e.indexOf(")")).split(":");return 3===t.length?new f(t[0],+t[1],+t[2]):new f("unknown",0,0)},a.getTranspileLocation=function(e){return e.substring(e.indexOf("(")+1,e.indexOf(")"))},a.getMapFilePath=function(e){var t=a.getTranspileLocation(e),r=t.substring(0,t.lastIndexOf(":"));return r.substring(0,r.lastIndexOf(":"))+".map"},a.getMapping=function(e,t){for(var r=0,n=0,o=0,i=e.mappings.split(";"),a=0;a<i.length;a++)for(var c=0,s=i[a].split(","),u=0;u<s.length;u++){var p=l.decode(s[u]);if(4<=p.length&&(c+=p[0],r+=p[1],n+=p[2],o+=p[3]),a===t.lineNumber){if(c===t.columnNumber)return new f(e.sources[r],n-1,o);if(u+1===s.length)return new f(e.sources[r],n-1,0)}}return new f("unknown",0,0)},a.prototype._getSourceMap=function(t,r){var n=this,e=new d.HttpRequest("GET",t);return this.httpBackend.handle(e).pipe(c.filter(function(e){return e instanceof d.HttpResponse}),c.map(function(e){return e.body}),c.map(function(e){return n.cache.hasOwnProperty(t)||(n.cache[t]=e),a.getMapping(e,r)}),c.retry(3),c.catchError(function(){return n.errorCache[t]=!0,s.of(r)}))},a.prototype.getCallerDetails=function(o){var i=this,e=a.getStackLine();return e?s.of([a.getPosition(e),a.getMapFilePath(e)]).pipe(c.switchMap(function(e){var t=u(e,2),r=t[0],n=t[1];return!o||i.errorCache.hasOwnProperty(n)?s.of(r):i.cache.hasOwnProperty(n)?s.of(a.getMapping(i.cache[n],r)):i._getSourceMap(n,r)})):s.of(new f("",0,0))},a}();p.decorators=[{type:t.Injectable}],p.ctorParameters=function(){return[{type:d.HttpBackend}]};var m=["TRACE","DEBUG","INFO","LOG","WARN","ERROR","FATAL","OFF"],g=function(){function e(e,t,r,n){this.mapperService=e,this.httpService=t,this.platformId=n,this._withCredentials=!1,this._isIE=o.isPlatformBrowser(n)&&!(-1===navigator.userAgent.indexOf("MSIE")&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.config=new a(r),this._logFunc=this._isIE?this._logIE.bind(this):this._logModern.bind(this)}return e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.TRACE,e,t)},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.DEBUG,e,t)},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.INFO,e,t)},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.LOG,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.WARN,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.ERROR,e,t)},e.prototype.fatal=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(y.FATAL,e,t)},e.prototype.setCustomHttpHeaders=function(e){this._customHttpHeaders=e},e.prototype.setCustomParams=function(e){this._customParams=e},e.prototype.setWithCredentialsOptionValue=function(e){this._withCredentials=e},e.prototype.registerMonitor=function(e){this._loggerMonitor=e},e.prototype.updateConfig=function(e){this.config.updateConfig(e)},e.prototype.getConfigSnapshot=function(){return this.config.getConfig()},e.prototype._logIE=function(e,t,r,n){switch(n=n||[],e){case y.WARN:console.warn.apply(console,i([t+" ",r],n));break;case y.ERROR:case y.FATAL:console.error.apply(console,i([t+" ",r],n));break;case y.INFO:console.info.apply(console,i([t+" ",r],n));break;default:console.log.apply(console,i([t+" ",r],n))}},e.prototype._logModern=function(e,t,r,n){var o=v.getColor(e);switch(n=n||[],e){case y.WARN:console.warn.apply(console,i(["%c"+t,"color:"+o,r],n));break;case y.ERROR:case y.FATAL:console.error.apply(console,i(["%c"+t,"color:"+o,r],n));break;case y.INFO:console.info.apply(console,i(["%c"+t,"color:"+o,r],n));break;default:console.log.apply(console,i(["%c"+t,"color:"+o,r],n))}},e.prototype._log=function(i,a,c,e){var s=this;void 0===c&&(c=[]),void 0===e&&(e=!0);var u=this.config.getConfig(),p=e&&u.serverLoggingUrl&&i>=u.serverLogLevel,l=i>=u.level;if(a&&(p||l)){var f=m[i];a=v.prepareMessage(a);var g=v.prepareAdditionalParameters(c),h=(new Date).toISOString();this.mapperService.getCallerDetails(u.enableSourceMaps).subscribe(function(e){var t={message:a,additional:g,level:i,timestamp:h,fileName:e.fileName,lineNumber:e.lineNumber.toString()};if(s._loggerMonitor&&l&&s._loggerMonitor.onLog(t),p){a=a instanceof Error?a.stack:a,t.message=a;var r=s._customHttpHeaders||new d.HttpHeaders;r.set("Content-Type","application/json");var n={headers:r,params:s._customParams||new d.HttpParams,responseType:u.httpResponseType||"json",withCredentials:s._withCredentials};s.httpService.logOnServer(u.serverLoggingUrl,t,n).subscribe(function(e){},function(e){s._log(y.ERROR,"FAILED TO LOG ON SERVER: "+a,[e],!1)})}if(l&&!u.disableConsoleLogging){var o=v.prepareMetaString(h,f,e.fileName,e.lineNumber.toString());return s._logFunc(i,o,a,c)}})}},e}();g.decorators=[{type:t.Injectable}],g.ctorParameters=function(){return[{type:p},{type:r},{type:n},{type:undefined,decorators:[{type:t.Inject,args:[t.PLATFORM_ID]}]}]};var h=function(){function e(e,t,r){this.mapperService=e,this.httpService=t,this.platformId=r}return e.prototype.create=function(e,t,r,n){var o=new g(n||this.mapperService,t||this.httpService,e,this.platformId);return r&&o.registerMonitor(r),o},e}();h.decorators=[{type:t.Injectable}],h.ctorParameters=function(){return[{type:p},{type:r},{type:undefined,decorators:[{type:t.Inject,args:[t.PLATFORM_ID]}]}]};var O=function A(){},N=function E(){},R=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:n,useValue:e||{}},g,r,h,p]}},t.forChild=function(){return{ngModule:t,providers:[g,r,h,p]}},t}();R.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule],providers:[g,r,h,p]}]}];var b=function(){function e(){}return e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.fatal=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},e.prototype.updateConfig=function(e){},e.prototype.setCustomHttpHeaders=function(e){},e.prototype.setCustomParams=function(e){},e.prototype.registerMonitor=function(e){},e.prototype.getConfigSnapshot=function(){return new n},e}(),C=function(){function e(){}return e.prototype.create=function(){return new b},e}(),L=function(){function e(){}return e.prototype.logOnServer=function(e,t,r,n,o){return s.of({})},e}(),w=function(){function e(){}return e.prototype.getCallerDetails=function(){return s.of({fileName:"test.ts",lineNumber:0,columnNumber:0})},e}(),S=function M(){};S.decorators=[{type:t.NgModule,args:[{providers:[{provide:g,useClass:b},{provide:r,useClass:L},{provide:h,useClass:C},{provide:p,useClass:w}]}]}],e.LoggerModule=R,e.Levels=m,e.NGXLogger=g,e.LoggerConfig=n,e.CustomNGXLoggerService=h,e.NGXLoggerMonitor=O,e.NGXLoggerHttpService=r,e.NGXMapperService=p,e.NGXLoggerUtils=v,e.NgxLoggerLevel=y,e.NGXLogInterface=N,e.NGXLoggerMock=b,e.CustomNGXLoggerServiceMock=C,e.NGXLoggerHttpServiceMock=L,e.LoggerTestingModule=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-logger.umd.min.js.map
